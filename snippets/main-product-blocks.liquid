{%- case block.type -%}
  {%- when '@app' -%}
    {% render block %}
      
  {%- when 'short-description' -%}
    <p style="font-size: 14px; line-height: 1.5; margin:0">
      {{ product.metafields.custom.product_short_description.value }}
    </p>
  {%- when 'text' -%}
    <h5>
      {{- block.settings.text |  upcase -}}
    </h5>
  {%- when 'FAQ' -%}
    <div>
      <style>

      .faq-block {
        position: relative;
        margin-top: calc(24.33vw * -1);
      }
      .faq-container{
        display:grid;
        grid-template-columns: 1fr minmax(auto, 60%);
        padding: var(--gutter);
        background: var(--heart);

      }

      .faq-header{
        width:50%;
      }

      .faq-header>h2{
        margin:0;
        text-transform:uppercase;
      }
      .faq-content>h4{
        margin:0;
        text-transform:uppercase;
        font-size:28px
      }

      .question{
        background-color: transparent;
        color:white;
        border:none;
        padding-bottom:20px;
      }
      .faq-content>p{
        display:none;
        max-width:90%;
      }
      .faq-content>p>a{
        color:white;
      }

      .faq-question{
        display:flex;
        align-items:center;
        margin-bottom:30px;
        cursor:pointer;
      }
      .faq-question>h4{
        margin:0;
        text-transform: uppercase;
        line-height:1.2;
        font-size:28px;
        width: 80%;
      }  

      .faq-question>h4>strong{
        font-weight: 500;
        letter-spacing: -1px;
      }

      @media screen and (min-width: 769px) {

      .faq-block {
        position: relative;
        margin-top: calc(8.33vw * -1);
      }
        .faq-container{
        padding: var(--verticalGutter) calc(var(--gutter) / 2) var(--verticalGutter) calc((100vw - 1261px) / 2);
       }
      .faq-question h4{
        font-size:32px
      }
      }
    </style>
    <div class="faq-block">
      <svg id="Layer_2" class="waveTop" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 194.35" style="position:relative;top: 7px; z-index:1">
               <path d="M 1440 0 S 1302.45 85.3 1200 85.3 C 1121.26 85.3 1024.74 36.41 941.49 36.41 C 790.51 36.41 657.57 151.27 511.56 151.27 C 389.21 151.27 303.9 51.32 141.86 51.32 C 68.78 51.3 0 64 0 64 V 193.35 H 1440 V 0 Z" fill="#ff0087"></path>
                <path d="M1440 20s-137.55 85.3-240 85.3c-78.74 0-175.26-48.89-258.51-48.89-150.98 0-283.92 114.86-429.93 114.86-122.35 0-207.66-99.95-369.7-99.95C68.78 71.33 0 84 0 84v109.35h1440V20Z" fill="#f9ed6c"></path>
                <path d="M1440 40s-137.55 85.3-240 85.3c-78.74 0-175.26-48.89-258.51-48.89-150.98 0-283.92 114.86-429.93 114.86-122.35 0-207.66-99.95-369.7-99.95C68.78 91.33 0 104 0 104v90.35h1440V40Z" fill="var(--heart)"></path>
              </svg>

    <div class="faq-container">
      
    <div class="faq-header">
      <h2>faq</h2>
    </div>
    <div>
      {% comment %} <div>
        {% comment %} type, handle, instance{% endcomment %}
         {{block.settings.faq_handle}}
          {% assign FAQ = metaobjects['pdp_faq'][block.settings.faq_handle].richmedia |  metafield_tag: field:  %}
          faq: {{ FAQ }}
          {% assign richmedia = FAQ |  metafield_tag %}
          rm: {{ richmedia }}
          {% for object in FAQ %}
            object: {{ object }}
          {% endfor %}
            {% assign QAPair = FAQ | split: "},{" %}
          {% for pair in QAPair %}
            {% assign formatted_pair = "" %}
            {% if forloop.first %}
              {% assign formatted_pair = pair | remove_first: '[{'  %}
              {% comment %} first pair: {{ formatted_pair }} {% endcomment %}
            {% elsif forloop.last %}
              {% assign formatted_pair = pair | remove_last: '}]'  %}
              {% comment %} last pair: {{ formatted_pair  }} {% endcomment %}
            {% else %}
            {% assign formatted_pair = pair  %}
                {% comment %} middle pair: {{ formatted_pair }} {% endcomment %}
            {% endif %}
            {% assign final_pair =  formatted_pair | split: '","' %}
              {% assign question = "" %}
              {% assign answer = "" %} 
            {% for string in final_pair %}
                {% if forloop.first %}
                  {% assign question = string |  remove_first: '"question":"'  %}
                {% else %}
                {% comment %} answer string {{ string }} {% endcomment %}
                {% assign answer = string |  remove_first :'answer":"' | remove_last: '"' %}
                {% comment %} post-process answer: {{ answer }} {% endcomment %}
                {% endif %}
              {% endfor %}

                <div class="qa-pair">
                  <button class="question h4 ">{{question}}</button>
                  <div class="answer answer-hidden">{{answer}} </div>
                </div>
            

          {% endfor %}
                
          </div>

      </div> {% endcomment %}
        <div class="faq-content">
          {{ block.settings.faq_text }}
        </div>
    
     </div>
         </div>
     <script>
        let faqQuestions = document.querySelectorAll('.faq-content>h4');
        let plusPath = 'M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3z'
        let minusPath = 'M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1z'
        faqQuestions.forEach((question) => {
          // Create wrapper div and add flex class
          const wrapper = document.createElement('div');
          wrapper.classList.add('faq-question');
          // Insert wrapper before question
          question.parentNode.insertBefore(wrapper, question);
          // Move question into wrapper
          wrapper.appendChild(question);
          // Create SVG element
          const svgNS = 'http://www.w3.org/2000/svg';
          const svg = document.createElementNS(svgNS, 'svg');
          svg.setAttribute('xmlns', svgNS);
          svg.setAttribute('width', '24');
          svg.setAttribute('height', '24');
          svg.setAttribute('fill', 'currentColor');
          svg.setAttribute('class', 'bi bi-plus-circle-fill');
          svg.setAttribute('viewBox', '0 0 16 16');
          const path = document.createElementNS(svgNS, 'path');
          
          path.setAttribute('d', plusPath);
          svg.appendChild(path);
          // Append SVG as sibling to h4 inside wrapper
          wrapper.appendChild(svg);
        });

        // Add flex CSS for alignment
        const style = document.createElement('style');
        style.textContent = `.faq-question-flex { display: flex; align-items: center; gap: 8px; }`;
        document.head.appendChild(style);

        // Existing FAQ toggle logic
        document.querySelectorAll('.faq-question').forEach((question) => {
          question.addEventListener('click', () => {
            let svgPath = question.querySelector('path')
            let operationType = question.nextElementSibling && question.nextElementSibling.style.display === 'block' ? "close" : "open";
            toggleNextParagraphs(question.nextElementSibling, operationType);
            function toggleNextParagraphs(element, operationType) {
              if (element && element.tagName === 'P') {
                element.style.display = operationType === "open" ? "block" : "none";
                operationType === 'open' ? svgPath.setAttribute('d', minusPath) : svgPath.setAttribute('d', plusPath);
                toggleNextParagraphs(element.nextElementSibling, operationType);
              }
            }
          });
        });
     </script>

    </div>
    

  {%- when 'title' -%}
      <h1 style="margin:0px">{{ product.title | escape | upcase }}</h1>
  {%- when 'price' -%}
    <div id="price-{{ section.id }}" role="status" {{ block.shopify_attributes }}>
      {%- render 'price',
        product: product,
        use_variant: true,
        show_badges: true,
        price_class: 'price--large'
      -%}
    </div>
    {%- if product.quantity_price_breaks_configured? -%}
      <div class="volume-pricing-note" id="Volume-Note-{{ section.id }}">
        <span>{{ 'products.product.volume_pricing.note' | t }}</span>
      </div>
    {%- endif -%}
    {%- if cart.taxes_included or cart.duties_included or shop.shipping_policy.body != blank -%}
      <div class="product__tax caption rte">
        {%- if cart.duties_included and cart.taxes_included -%}
          {{ 'products.product.duties_and_taxes_included' | t }}
        {%- elsif cart.taxes_included -%}
          {{ 'products.product.taxes_included' | t }}
        {%- elsif cart.duties_included -%}
          {{ 'products.product.duties_included' | t }}
        {%- endif -%}
        {%- if shop.shipping_policy.body != blank -%}
          {{ 'products.product.shipping_policy_html' | t: link: shop.shipping_policy.url }}
        {%- endif -%}
      </div>
    {%- endif -%}
    <div {{ block.shopify_attributes }}>
      {%- assign product_form_installment_id = 'product-form-installment-' | append: section.id -%}
      {%- form 'product', product, id: product_form_installment_id, class: 'installment caption-large' -%}
        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
        {{ form | payment_terms }}
      {%- endform -%}
    </div>
  {%- when 'inventory' -%}
    <p
      class="product__inventory{% if block.settings.text_style == 'uppercase' %} caption-with-letter-spacing{% elsif block.settings.text_style == 'subtitle' %} subtitle{% endif %}{% if product.selected_or_first_available_variant.inventory_management != 'shopify' %} visibility-hidden{% endif %}"
      {{ block.shopify_attributes }}
      id="Inventory-{{ section.id }}"
      role="status"
    >
      {%- if product.selected_or_first_available_variant.inventory_management == 'shopify' -%}
        {%- if product.selected_or_first_available_variant.inventory_quantity > 0 -%}
          {%- if product.selected_or_first_available_variant.inventory_quantity
              <= block.settings.inventory_threshold
          -%}
            <span class="svg-wrapper" style="color: rgb(238, 148, 65)">
              {{- 'icon-inventory-status.svg' | inline_asset_content -}}
            </span>
            {%- if block.settings.show_inventory_quantity -%}
              {{-
                'products.product.inventory_low_stock_show_count'
                | t: quantity: product.selected_or_first_available_variant.inventory_quantity
              -}}
            {%- else -%}
              {{- 'products.product.inventory_low_stock' | t -}}
            {%- endif -%}
          {%- else -%}
            <span class="svg-wrapper" style="color: rgb(62, 214, 96)">
              {{- 'icon-inventory-status.svg' | inline_asset_content -}}
            </span>
            {%- if block.settings.show_inventory_quantity -%}
              {{-
                'products.product.inventory_in_stock_show_count'
                | t: quantity: product.selected_or_first_available_variant.inventory_quantity
              -}}
            {%- else -%}
              {{- 'products.product.inventory_in_stock' | t -}}
            {%- endif -%}
          {%- endif -%}
        {%- else -%}
          {%- if product.selected_or_first_available_variant.inventory_policy == 'continue' -%}
            <span class="svg-wrapper" style="color: rgb(62, 214, 96)">
              {{- 'icon-inventory-status.svg' | inline_asset_content -}}
            </span>
            {{- 'products.product.inventory_out_of_stock_continue_selling' | t -}}
          {%- else -%}
            <span class="svg-wrapper" style="color: rgb(200, 200, 200)">
              {{- 'icon-inventory-status.svg' | inline_asset_content -}}
            </span>
            {{- 'products.product.inventory_out_of_stock' | t -}}
          {%- endif -%}
        {%- endif -%}
      {%- endif -%}
    </p>
  {%- when 'description' -%}
    <style>
      .product-description-container{
        margin-top:calc(13.33vw * -1);
        position:relative;
        margin-bottom:calc(17.33vw * -1);
      }

      @media and screen (min-width: 798px){
         .product-description-container{
        margin-bottom:calc(9.33vw * -1)
      }
      }
    </style>
    {%- if product.description != blank -%}
      
      <div class="rte quick-add-hidden" {{ block.shopify_attributes }} style="background:#fd7ad4; position:relative; z-index:1">
        <div class="product-description-container" style="">
            <svg id="Layer_2" class="waveTop" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 194.35" style="position:relative;top: 7px; z-index:1">
               <path d="M 1440 0 S 1302.45 85.3 1200 85.3 C 1121.26 85.3 1024.74 36.41 941.49 36.41 C 790.51 36.41 657.57 151.27 511.56 151.27 C 389.21 151.27 303.9 51.32 141.86 51.32 C 68.78 51.3 0 64 0 64 V 193.35 H 1440 V 0 Z" fill="#ff0087"></path>
                <path d="M1440 20s-137.55 85.3-240 85.3c-78.74 0-175.26-48.89-258.51-48.89-150.98 0-283.92 114.86-429.93 114.86-122.35 0-207.66-99.95-369.7-99.95C68.78 71.33 0 84 0 84v109.35h1440V20Z" fill="#f9ed6c"></path>
                <path d="M1440 40s-137.55 85.3-240 85.3c-78.74 0-175.26-48.89-258.51-48.89-150.98 0-283.92 114.86-429.93 114.86-122.35 0-207.66-99.95-369.7-99.95C68.78 91.33 0 104 0 104v90.35h1440V40Z" fill="#fd7ad4"></path>
              </svg>
          <div class="product_description" >
          <div>
            <div>&nbsp;</div>
            {{ product.description }}
           </div>  
           <div>
            {{ product.metafields.custom.product_additional_information |  metafield_tag }}
           </div>
         </div>
          <svg data-name="Layer 3" class="waveBottom" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 194.35" style="position:inherit;top:-1px">
  <path d="M706.45 109.26C782.8 78.3 859.48 46.41 941.49 46.41S1121.26 95.3 1200 95.3c102.45 0 240-95.3 240-95.3H0v73s68.78-11.7 141.86-11.68c162.04 0 247.35 99.95 369.7 99.95 60.7 0 119.14-23.85 177.56-47.05l17.33-4.96Z" fill="var(--pink)"></path>
  <path d="M1200 85.3c-78.74 0-175.26-48.89-258.51-48.89S782.8 70.3 706.45 101.26c-5.78 2.34-11.55 4.67-17.33 6.96-58.42 23.2-116.86 43.05-177.56 43.05-122.35 0-207.66-99.95-369.7-99.95C68.78 51.3 0 64 0 64v30s68.78-12.67 141.86-12.68c162.04 0 247.35 99.95 369.7 99.95 146.01 0 278.95-114.86 429.93-114.86 83.25 0 179.77 48.89 258.51 48.89 102.45 0 240-85.3 240-85.3V0s-137.55 85.3-240 85.3Z" fill="#ff0087""></path>
  <path d="M941.49 56.41c-150.98 0-283.92 114.86-429.93 114.86-122.35 0-207.66-99.95-369.7-99.95C68.78 71.33 0 84 0 84v20s68.78-12.67 141.86-12.68c162.04 0 247.35 99.95 369.7 99.95 146.01 0 278.95-114.86 429.93-114.86 83.25 0 179.77 48.89 258.51 48.89 102.45 0 240-85.3 240-85.3V20s-137.55 85.3-240 85.3c-78.74 0-175.26-48.89-258.51-48.89Z" fill="#f9ed6c"></path>
</svg>
        </div>
      </div>
      
    {%- endif -%}
  {%- when 'sku' -%}
    <p
      class="product__sku{% if block.settings.text_style == 'uppercase' %} caption-with-letter-spacing{% elsif block.settings.text_style == 'subtitle' %} subtitle{% endif %}{% if product.selected_or_first_available_variant.sku.size == 0 %} visibility-hidden{% endif %}"
      id="Sku-{{ section.id }}"
      role="status"
      {{ block.shopify_attributes }}
    >
      <span class="visually-hidden">{{ 'products.product.sku' | t }}:</span>
      {{- product.selected_or_first_available_variant.sku -}}
    </p>
  {%- when 'custom_liquid' -%}
    {{ block.settings.custom_liquid }}
  {%- when 'collapsible_tab' -%}
    <div class="product__accordion accordion quick-add-hidden" {{ block.shopify_attributes }}>
      <details id="Details-{{ block.id }}-{{ section.id }}">
        <summary>
          <div class="summary__title">
            {% render 'icon-accordion', icon: block.settings.icon %}
            <h2 class="h4 accordion__title inline-richtext">
              {{ block.settings.heading | default: block.settings.page.title | escape }}
            </h2>
          </div>
          {{- 'icon-caret.svg' | inline_asset_content -}}
        </summary>
        <div class="accordion__content rte" id="ProductAccordion-{{ block.id }}-{{ section.id }}">
          {{ block.settings.content }}
          {{ block.settings.page.content }}
        </div>
      </details>
    </div>
  {%- when 'lifestyle_carrousel' %}
    <style>

      .glide{
        position:relative;
      }
      .glide__track{
        display:flex;
        flex-direction: row;
        max-width: 100vw;
        overflow:clip;
      }

      .glide__slides{
        display:flex;
        padding:0;
      }

      .glide__arrows{
     position: absolute;
     z-index: 2;
     top: 38%;
     width: 100%;
     display: flex;
     justify-content: space-between;
     padding: 0 21px;
    }

    .glide__arrow{
      cursor:pointer;
    }

    .glide__arrow:active svg{
       fill:black;
    }

    @media screen and (min-width: 769px){
      .glide__arrows{
         top: 56%;
      }
    }
      
    </style>
    <div style="overflow:auto">
      <div class="glide">
        <div class="glide__track" data-glide-el="track">
          <ul class="glide__slides">
            {% for i in (1..3) %}
         {% case i %}
           {% when 1 %}
              {% if block.settings.lifestyle_carrousel_image_1 %}
                <li class="glide__slide">
                  <img src="{{  block.settings.lifestyle_carrousel_image_1 |  image_url }}" width="450px" style="max-width:100vw; width:100%"/>
                </li>
              {% endif %}
           {% when 2 %}
              {% if block.settings.lifestyle_carrousel_image_2 %}
                <li class="glide__slide">
                  <img src="{{ block.settings.lifestyle_carrousel_image_2 |  image_url }}" width="450px" style="max-width:100vw; width:100%"/>
                </li>
              {% endif %}
           {% when 3 %}
              {% if block.settings.lifestyle_carrousel_image_3 %}
                <li class="glide__slide">
                  <img src="{{ block.settings.lifestyle_carrousel_image_3 | image_url }}" width="450px" style="max-width:100vw; width:100%"/>
                </li>
              {% endif %}
            {% endcase %}
      {% endfor %} 
          </ul>
        </div>
        <div class="glide__arrows" data-glide-el="controls">
    <span class="glide__arrow glide__arrow--left" data-glide-dir="<"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-arrow-left-circle" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z"/>
</svg>

</span>
    <span class="glide__arrow glide__arrow--right" data-glide-dir=">"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-arrow-right-circle" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5z"/>
</svg></span>
  </div>
      </div>
      
    </div>
    <script>
      let glide = new Glide('.glide', {
      type: 'slider',
      rewind: false,
      bound: true,
      startAt: 0,
      gap:0,
      perView: 1,
      peek:0
    }).mount()

    console.log(glide)


    </script>
  {%- when 'quantity_selector' -%}
    <div
      id="Quantity-Form-{{ section.id }}"
      class=" product-form__quantity{% if settings.inputs_shadow_vertical_offset != 0 and settings.inputs_shadow_vertical_offset < 0 %} product-form__quantity-top{% endif %}"
      {{ block.shopify_attributes }}
    >
      {% comment %} TODO: enable theme-check once `item_count_for_variant` is accepted as valid filter {% endcomment %}
      {% # theme-check-disable %}
      {%- assign cart_qty = cart
        | item_count_for_variant: product.selected_or_first_available_variant.id
      -%}
      {% # theme-check-enable %}
      <label class="quantity__label form__label" for="Quantity-{{ section.id }}" style="display:none">
        {{ 'products.product.quantity.label' | t }}
        <span class="quantity__rules-cart{% if cart_qty == 0 %} hidden{% endif %}">
          {%- render 'loading-spinner' -%}
          <span
            >(
            {{- 'products.product.quantity.in_cart_html' | t: quantity: cart_qty -}}
            )</span
          >
        </span>
      </label>
      <div class="price-per-item__container">
        <quantity-input class="quantity" data-url="{{ product.url }}" data-section="{{ section.id }}">
          <button class="quantity__button" name="minus" type="button">
            <span class="visually-hidden">
              {{- 'products.product.quantity.decrease' | t: product: product.title | escape -}}
            </span>
            <span class="svg-wrapper">
              {{- 'icon-minus.svg' | inline_asset_content -}}
            </span>
          </button>
          <input
            class="quantity__input"
            type="number"
            name="quantity"
            id="Quantity-{{ section.id }}"
            data-cart-quantity="{{ cart_qty }}"
            data-min="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
            min="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
            {% if product.selected_or_first_available_variant.quantity_rule.max != null %}
              data-max="{{ product.selected_or_first_available_variant.quantity_rule.max }}"
              max="{{ product.selected_or_first_available_variant.quantity_rule.max }}"
            {% endif %}
            step="{{ product.selected_or_first_available_variant.quantity_rule.increment }}"
            value="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
            form="{{ product_form_id }}"
          >
          <button class="quantity__button" name="plus" type="button">
            <span class="visually-hidden">
              {{- 'products.product.quantity.increase' | t: product: product.title | escape -}}
            </span>
            <span class="svg-wrapper">
              {{- 'icon-plus.svg' | inline_asset_content -}}
            </span>
          </button>
        </quantity-input>
        {%- liquid
          assign volume_pricing_array = product.selected_or_first_available_variant.quantity_price_breaks | sort: 'quantity' | reverse
          assign current_qty_for_volume_pricing = cart_qty | plus: product.selected_or_first_available_variant.quantity_rule.min
          if cart_qty > 0
            assign current_qty_for_volume_pricing = cart_qty | plus: product.selected_or_first_available_variant.quantity_rule.increment
          endif
        -%}
        {%- if product.quantity_price_breaks_configured? -%}
          <price-per-item
            id="Price-Per-Item-{{ section.id }}"
            data-section-id="{{ section.id }}"
            data-variant-id="{{ product.selected_or_first_available_variant.id }}"
          >
            {%- if product.selected_or_first_available_variant.quantity_price_breaks.size > 0 -%}
              {%- assign variant_price_compare = product.selected_or_first_available_variant.compare_at_price -%}
              <div class="price-per-item">
                {%- if variant_price_compare -%}
                  <dl class="price-per-item--current">
                    <dt class="visually-hidden">
                      {{ 'products.product.price.regular_price' | t }}
                    </dt>
                    <dd>
                      <s class="variant-item__old-price">
                        {{ variant_price_compare | money_with_currency }}
                      </s>
                    </dd>
                  </dl>
                {%- endif -%}
                {%- if current_qty_for_volume_pricing < volume_pricing_array.last.minimum_quantity -%}
                  {%- assign variant_price = product.selected_or_first_available_variant.price
                    | money_with_currency
                  -%}
                  <span class="price-per-item--current">
                    {{- 'products.product.volume_pricing.price_at_each_html' | t: price: variant_price -}}
                  </span>
                {%- else -%}
                  {%- for price_break in volume_pricing_array -%}
                    {%- if current_qty_for_volume_pricing >= price_break.minimum_quantity -%}
                      {%- assign price_break_price = price_break.price | money_with_currency -%}
                      <span class="price-per-item--current">
                        {{-
                          'products.product.volume_pricing.price_at_each_html'
                          | t: price: price_break_price
                        -}}
                      </span>
                      {%- break -%}
                    {%- endif -%}
                  {%- endfor -%}
                {%- endif -%}
              </div>
            {%- else -%}
              {%- assign variant_price = product.selected_or_first_available_variant.price
                | money_with_currency
              -%}
              {%- assign variant_price_compare = product.selected_or_first_available_variant.compare_at_price -%}
              <div class="price-per-item">
                {%- if variant_price_compare -%}
                  <dl class="price-per-item--current">
                    <dt class="visually-hidden">
                      {{ 'products.product.price.regular_price' | t }}
                    </dt>
                    <dd>
                      <s class="variant-item__old-price">
                        {{ variant_price_compare | money_with_currency }}
                      </s>
                    </dd>
                    <dt class="visually-hidden">
                      {{ 'products.product.price.sale_price' | t }}
                    </dt>
                    <dd>
                      <span class="price-per-item--current">
                        {{- 'products.product.volume_pricing.price_at_each_html' | t: price: variant_price -}}
                      </span>
                    </dd>
                  </dl>
                {%- else -%}
                  <span class="price-per-item--current">
                    {{- 'products.product.volume_pricing.price_at_each_html' | t: price: variant_price -}}
                  </span>
                {%- endif -%}
              </div>
            {%- endif -%}
          </price-per-item>
        {%- endif -%}
      </div>
      <div class="quantity__rules caption" id="Quantity-Rules-{{ section.id }}">
        {%- if product.selected_or_first_available_variant.quantity_rule.increment > 1 -%}
          <span class="divider">
            {{-
              'products.product.quantity.multiples_of'
              | t: quantity: product.selected_or_first_available_variant.quantity_rule.increment
            -}}
          </span>
        {%- endif -%}
        {%- if product.selected_or_first_available_variant.quantity_rule.min > 1 -%}
          <span class="divider">
            {{-
              'products.product.quantity.minimum_of'
              | t: quantity: product.selected_or_first_available_variant.quantity_rule.min
            -}}
          </span>
        {%- endif -%}
        {%- if product.selected_or_first_available_variant.quantity_rule.max != null -%}
          <span class="divider">
            {{-
              'products.product.quantity.maximum_of'
              | t: quantity: product.selected_or_first_available_variant.quantity_rule.max
            -}}
          </span>
        {%- endif -%}
      </div>
      {%- if product.quantity_price_breaks_configured? -%}
        <volume-pricing class="parent-display" id="Volume-{{ section.id }}">
          {%- if product.selected_or_first_available_variant.quantity_price_breaks.size > 0 -%}
            <span class="caption-large">{{ 'products.product.volume_pricing.title' | t }}</span>
            <ul class="list-unstyled">
              <li>
                <span>{{ product.selected_or_first_available_variant.quantity_rule.min }}+</span>
                {%- assign price = product.selected_or_first_available_variant.price
                  | money_with_currency
                -%}
                <span data-text="{{ 'products.product.volume_pricing.price_at_each_html' | t: price: variant_price }}">
                  {{- 'sections.quick_order_list.each' | t: money: price -}}
                </span>
              </li>
              {%- for price_break in product.selected_or_first_available_variant.quantity_price_breaks -%}
                {%- assign price_break_price = price_break.price | money_with_currency -%}
                <li class="{%- if forloop.index >= 3 -%}show-more-item hidden{%- endif -%}">
                  <span>
                    {{- price_break.minimum_quantity -}}
                    <span aria-hidden="true">+</span></span
                  >
                  <span data-text="{{ 'products.product.volume_pricing.price_at_each_html' | t: price: price_break_price }}">
                    {{- 'sections.quick_order_list.each' | t: money: price_break_price -}}
                  </span>
                </li>
              {%- endfor -%}
            </ul>
            {%- if product.selected_or_first_available_variant.quantity_price_breaks.size >= 3 -%}
              <show-more-button>
                <button
                  class="button-show-more link underlined-link"
                  id="Show-More-{{ section.id }}"
                  type="button"
                >
                  <span class="label-show-more label-text"
                    ><span aria-hidden="true">+ </span>{{ 'products.facets.show_more' | t }}
                  </span>
                </button>
              </show-more-button>
            {%- endif -%}
          {%- endif -%}
        </volume-pricing>
            
      {%- endif -%}
      {%- render 'buy-buttons',
      block: block,
      product: product,
      product_form_id: product_form_id,
      section_id: section.id,
      show_pickup_availability: true
    -%}
    </div>
  {%- when 'popup' -%}
    <modal-opener
      class="product-popup-modal__opener quick-add-hidden"
      data-modal="#PopupModal-{{ block.id }}"
      {{ block.shopify_attributes }}
    >
      <button
        id="ProductPopup-{{ block.id }}"
        class="product-popup-modal__button link"
        type="button"
        aria-haspopup="dialog"
      >
        {{ block.settings.text | default: block.settings.page.title | escape }}
      </button>
    </modal-opener>
  {%- when 'share' -%}
    {% liquid
      assign share_url = product.selected_variant.url | default: product.url | prepend: request.origin
      render 'share-button', block: block, share_link: share_url
    %}

  {%- when 'variant_picker' -%}
    {% render 'product-variant-picker', product: product, block: block, product_form_id: product_form_id %}
  {%- when 'rating' -%}
    {%- if product.metafields.reviews.rating.value != blank -%}
      <div class="rating-wrapper">
        {% liquid
          assign rating_decimal = 0
          assign decimal = product.metafields.reviews.rating.value.rating | modulo: 1
          if decimal >= 0.3 and decimal <= 0.7
            assign rating_decimal = 0.5
          elsif decimal > 0.7
            assign rating_decimal = 1
          endif
        %}
        <div
          class="rating"
          role="img"
          aria-label="{{ 'accessibility.star_reviews_info' | t: rating_value: product.metafields.reviews.rating.value, rating_max: product.metafields.reviews.rating.value.scale_max }}"
        >
          <span
            aria-hidden="true"
            class="rating-star"
            style="--rating: {{ product.metafields.reviews.rating.value.rating | floor }}; --rating-max: {{ product.metafields.reviews.rating.value.scale_max }}; --rating-decimal: {{ rating_decimal }};"
          ></span>
        </div>
        <p class="rating-text caption">
          <span aria-hidden="true">
            {{- product.metafields.reviews.rating.value }} /
            {{ product.metafields.reviews.rating.value.scale_max -}}
          </span>
        </p>
        <p class="rating-count caption">
          <span aria-hidden="true">({{ product.metafields.reviews.rating_count }})</span>
          <span class="visually-hidden">
            {{- product.metafields.reviews.rating_count }}
            {{ 'accessibility.total_reviews' | t -}}
          </span>
        </p>
      </div>
    {%- endif -%}
  {%- when 'complementary' -%}
    <product-recommendations
      class="complementary-products quick-add-hidden{% if block.settings.make_collapsible_row %} is-accordion{% endif %}{% if block.settings.enable_quick_add %} complementary-products-contains-quick-add{% endif %}"
      data-url="{{ routes.product_recommendations_url }}?limit={{ block.settings.product_list_limit }}&intent=complementary"
      data-section-id="{{ section.id }}"
      data-product-id="{{ product.id }}"
    >
      {%- if recommendations.performed and recommendations.products_count > 0 -%}
        <aside
          aria-label="{{ 'accessibility.complementary_products' | t }}"
          {{ block.shopify_attributes -}}
          {% if block.settings.make_collapsible_row %}
            class="product__accordion accordion"
          {% endif %}
        >
          <div class="complementary-products__container">
            {%- if block.settings.make_collapsible_row -%}
              <details id="Details-{{ block.id }}-{{ section.id }}" open>
                <summary>
            {%- endif %}
            <div class="summary__title">
              {%- if block.settings.make_collapsible_row -%}
                {% render 'icon-accordion', icon: block.settings.icon %}
                <h2 class="h4 accordion__title">{{ block.settings.block_heading }}</h2>
              {%- else -%}
                <h2 class="h3 accordion__title">{{ block.settings.block_heading }}</h2>
              {%- endif -%}
            </div>
            {%- if block.settings.make_collapsible_row -%}
              {{- 'icon-caret.svg' | inline_asset_content -}}
              </summary>
            {%- endif -%}
            <slideshow-component class="slider-mobile-gutter">
              {%- assign number_of_slides = recommendations.products_count
                | plus: 0.0
                | divided_by: block.settings.products_per_page
                | ceil
              -%}
              <div
                id="Slider-{{ block.id }}"
                class="contains-card contains-card--product complementary-slider grid grid--1-col slider slider--everywhere"
                role="list"
                {% if number_of_slides > 1 %}
                  aria-label="{{ 'general.slider.name' | t }}"
                {% endif %}
              >
                {% assign skip_card_product_styles = false %}
                {%- for i in (1..number_of_slides) -%}
                  <div
                    id="Slide-{{ block.id }}-{{ forloop.index }}"
                    class="complementary-slide complementary-slide--{{ settings.card_style }} grid__item slider__slide slideshow__slide"
                    tabindex="-1"
                    role="group"
                    {% if number_of_slides > 1 %}
                      aria-roledescription="{{ 'sections.slideshow.slide' | t }}"
                      aria-label="{{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}"
                    {% endif %}
                  >
                    <ul class="list-unstyled" role="list">
                      {%- for product in recommendations.products
                        limit: block.settings.products_per_page
                        offset: continue
                      -%}
                        <li>
                          {%- if block.settings.enable_quick_add -%}
                            {% assign quick_add = 'standard' %}
                          {%- else -%}
                            {% assign quick_add = 'none' %}
                          {%- endif -%}
                          {% render 'card-product',
                            card_product: product,
                            media_aspect_ratio: block.settings.image_ratio,
                            show_secondary_image: false,
                            lazy_load: false,
                            skip_styles: skip_card_product_styles,
                            quick_add: quick_add,
                            section_id: section.id,
                            horizontal_class: true,
                            horizontal_quick_add: true
                          %}
                        </li>
                        {%- assign skip_card_product_styles = true -%}
                      {%- endfor -%}
                    </ul>
                  </div>
                {%- endfor -%}
              </div>
              {%- if number_of_slides > 1 -%}
                <div class="slider-buttons">
                  <button
                    type="button"
                    class="slider-button slider-button--prev"
                    name="previous"
                    aria-label="{{ 'general.slider.previous_slide' | t }}"
                  >
                    <span class="svg-wrapper">
                      {{- 'icon-caret.svg' | inline_asset_content -}}
                    </span>
                  </button>
                  <div class="slider-counter slider-counter--{{ block.settings.pagination_style }}{% if block.settings.pagination_style == 'counter' or block.settings.pagination_style == 'numbers' %} caption{% endif %}">
                    {%- if block.settings.pagination_style == 'counter' -%}
                      <span class="slider-counter--current">1</span>
                      <span aria-hidden="true"> / </span>
                      <span class="visually-hidden">{{ 'general.slider.of' | t }}</span>
                      <span class="slider-counter--total">{{ number_of_slides }}</span>
                    {%- else -%}
                      <div class="slideshow__control-wrapper">
                        {%- for i in (1..number_of_slides) -%}
                          <button
                            class="slider-counter__link slider-counter__link--{{ block.settings.pagination_style }} link"
                            aria-label="{{ 'sections.slideshow.load_slide' | t }} {{ forloop.index }} {{ 'general.slider.of' | t }} {{ forloop.length }}"
                            aria-controls="Slider-{{ block.id }}"
                          >
                            {%- if block.settings.pagination_style == 'numbers' -%}
                              {{ forloop.index -}}
                            {%- else -%}
                              <span class="dot"></span>
                            {%- endif -%}
                          </button>
                        {%- endfor -%}
                      </div>
                    {%- endif -%}
                  </div>
                  <button
                    type="button"
                    class="slider-button slider-button--next"
                    name="next"
                    aria-label="{{ 'general.slider.next_slide' | t }}"
                  >
                    <span class="svg-wrapper">
                      {{- 'icon-caret.svg' | inline_asset_content -}}
                    </span>
                  </button>
                </div>
              {%- endif -%}
            </slideshow-component>
            {%- if block.settings.make_collapsible_row -%}
              </details>
            {%- endif -%}
          </div>
        </aside>
      {%- endif -%}
      {{ 'component-card.css' | asset_url | stylesheet_tag }}
      {{ 'component-complementary-products.css' | asset_url | stylesheet_tag }}
      {%- if block.settings.enable_quick_add -%}
        {{ 'quick-add.css' | asset_url | stylesheet_tag }}
        <script src="{{ 'quick-add.js' | asset_url }}" defer="defer"></script>
      {%- endif -%}
    </product-recommendations>
  {%- when 'icon-with-text' -%}
    {% render 'icon-with-text', block: block %}
{%- endcase -%}